<!-- start custom head snippets -->

<link rel="stylesheet" href="/resource/styles.css">

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/logo/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicons/logo/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicons/logo/favicon-16x16.png">
<link rel="manifest" href="/assets/images/favicons/logo/site.webmanifest">
<link rel="mask-icon" href="/assets/images/favicons/logo/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Define all theorem-like types
    const theoremTypes = ['algorithm', 'axiom', 'conjecture', 'corollary', 'definition', 'formula', 'inequality', 'law', 'lemma', 'principle', 'proposition', 'theorem'];
    // Create a map of IDs to numbers and data names
    const theoremNumbers = {};
    const dataNames = {};

    // Process each type separately for separate numbering
    theoremTypes.forEach(type => {
        const elements = document.querySelectorAll(`.${type}`);
        elements.forEach((element, index) => {
            if (element.id) {
                theoremNumbers[element.id] = index + 1;
                // Use getAttribute to get the data-name attribute
                dataNames[element.id] = element.getAttribute('data-name') || '';
            }
        });
    });

    // Update all theorem references
    document.querySelectorAll('a[href^="#"]').forEach(link => {
        const targetId = link.getAttribute('href').substring(1);
        if (theoremNumbers[targetId]) {
            const target = document.getElementById(targetId);
            // Find which theorem type this element is
            const matchingType = theoremTypes.find(type => target.classList.contains(type));
            if (matchingType) {
                const type = matchingType.charAt(0).toUpperCase() + matchingType.slice(1);
                const dataName = dataNames[targetId];
                // Include data-name in brackets if it exists
                if (dataName) {
                    link.textContent = `${type} ${theoremNumbers[targetId]} [${dataName}]`;
                } else {
                    link.textContent = `${type} ${theoremNumbers[targetId]}`;
                }
            }
        }
    });
});
</script>

<script>
// Get the 'video' parameter from URL
const urlParams = new URLSearchParams(window.location.search);
const videoId = urlParams.get('video');

if (videoId) {
    // Find the element and play the video
    const container = document.getElementById(videoId);
    if (container) {
        const video = container.querySelector('video');
        if (video) {
            video.play();
            // Optional: scroll to the video
            container.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    }
}

// Function to get URL parameters
function getUrlParameter(name) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(name);
}

// Function to auto-play audio based on URL parameter
function autoPlayAudio() {
    const audioParam = getUrlParameter('audio');
    if (audioParam) {
        const audioElement = document.getElementById(audioParam);
        if (audioElement) {
            // Scroll to the audio element
            audioElement.scrollIntoView({ behavior: 'smooth', block: 'center' });

            // Add a small delay to ensure the page has loaded
            setTimeout(() => {
                audioElement.play().catch(error => {
                    console.log('Auto-play was prevented by browser:', error);
                    // Highlight the audio element if auto-play fails
                    audioElement.style.border = '3px solid #ff6b6b';
                    audioElement.style.borderRadius = '5px';
                });
            }, 500);
			// Alternative: Simulate click on play button
			/*
			setTimeout(() => {
				audioElement.play().catch(error => {
					// If auto-play fails, show a prominent play button or notification
					const playButton = document.createElement('button');
					playButton.textContent = 'â–¶ Click to Play Selected Audio';
					playButton.style.cssText = `
						position: fixed;
						top: 20px;
						right: 20px;
						z-index: 1000;
						background: #007cba;
						color: white;
						border: none;
						padding: 10px 20px;
						border-radius: 5px;
						cursor: pointer;
						font-size: 16px;
					`;
					playButton.onclick = () => {
						audioElement.play();
						document.body.removeChild(playButton);
					};
					document.body.appendChild(playButton);
				});
			}, 500);
			*/
        }
    }
}

// Run the function when the page loads
document.addEventListener('DOMContentLoaded', autoPlayAudio);
</script>

{% if page.usemathjax %}
<script>
window.MathJax = {
  tex: {
    tags: 'ams',
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']]
  }
};
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
{% endif %}
<!-- end custom head snippets -->
